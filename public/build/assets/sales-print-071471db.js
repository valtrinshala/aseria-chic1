window.invoicePrinting=(g,l=!1)=>{F(g,null,null,l)};window.stickerPrinting=(g,l,c=null,h=!1)=>{const L={width:g,height:c};c==null&&(L.replaceHeight=!0),F(l,L,{pad:{left:40}},h)};$(document).on("click",".print-btn",function(){const g=document.getElementById("printer-string");g&&"value"in g&&g.value!=""&&F(g.value)});$(document).ready(()=>{if(invoicePrinting("CL: Debug;",!0),stickerPrinting(80,"CL: Debug;",null,!0),"Main"in window){let g=document.getElementsByClassName("show-app");for(let l of g)l.classList.remove("d-none")}$("#delete-order").click(function(){var g=$(this).data("order-id");Swal.fire({text:window.keys.deleteText+"?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonText,cancelButtonText:window.keys.cancelButtonText,customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then(function(l){l.value?$.ajax({url:"/admin/order/"+g,method:"DELETE",contentType:!1,processData:!1,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(c){location.href="/admin/order"},error:function(c,h,L){}}):l.dismiss==="cancel"&&Swal.fire({text:window.keys.notDeleted,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})})})});function D(g){return new Promise((l,c)=>{const h=new Image;h.onload=()=>{l(h)},h.onerror=()=>{l(0)},h.src=g})}function E(g){return new Promise((l,c)=>{$.ajax({method:"GET",url:"/admin/getBase64Image?value="+g,success:h=>{const L="data:image/png;base64,"+h,T=new Image;T.onload=()=>{l(T)},T.onerror=()=>{l(0)},T.src=L},error:h=>{console.log(h),l(0)}})})}async function F(g,l=null,c=null,h=!1){let T=50;"invoicePrintSettings"in window&&"logo_height"in window.invoicePrintSettings&&!isNaN(parseFloat(window.invoicePrintSettings.logo_height))&&(T=parseFloat(window.invoicePrintSettings.logo_height));let n={logo:{height:T},spacing:{height:24*.5},font:{size:24,family:"NanumGothicCoding",spacing:10,last:24,weight:"normal"},padding:{top:24,left:0,right:0,bottom:24+76}};c&&"pad"in c&&("top"in c.pad&&(n.padding.top+=c.pad.top),"bottom"in c.pad&&(n.padding.bottom+=c.pad.bottom),"left"in c.pad&&(n.padding.left+=c.pad.left),"right"in c.pad&&(n.padding.right+=c.pad.right));const v={wordSplit(t,r,s,d=0){const e=[],a=r.split(" ");let i="",f=0;for(let u of a){if(f==0){i=u,f++;continue}let w=i+" "+u;e.length!=0&&(w="".padEnd(d)+w),t.measureText(w).width>s?(e.length!=0&&(i="".padEnd(d)+i),e.push(i),i=u):i+=" "+u,f++}e.push(i);let b=[],p=parseInt(d);if(!isNaN(p)&&p!=0){let u=0;for(let w of e){u++;let B=w;u!=1&&(B="".padEnd(p)+w),b.push(B)}}else b=e;return b}},m={row:{noReset:["RRL","LRL","LRF","RRF"],initialY:0,y:0}},P={LOGO:function(t,r){return new Promise(async(s,d)=>{const e=await D(r);if(e!=0){t.filter="grayscale(1)";const a=e.width/e.height;let i=n.logo.height,f=i*a;f>t.can.width&&(f=t.can.width,i=f/a);let b=t.can.width*.5-f*.5;t.drawImage(e,0,0,e.width,e.height,b,t.currentY,f,i),t.currentY+=i+n.spacing.height}s(!0)})},LR:function(t,r){t.currentY+=parseFloat(r)*n.spacing.height},LRR:function(t,r){t.currentY-=parseFloat(r)*n.spacing.height*.5},FL:function(t,r=1.5){let s=parseFloat(r);isNaN(s)&&(s=1.5),t.setLineDash([8]),t.lineWidth=s,t.moveTo(0,t.currentY),t.lineTo(o.width,t.currentY),t.stroke(),t.setLineDash([]),t.currentY+=n.spacing.height*4},R:function(t,r){t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;const s=t.measureText("A");s.fontBoundingBoxAscent-s.fontBoundingBoxDescent+n.font.spacing},B:function(t,r){n.font.weight="600"},UB:function(t,r){n.font.weight="normal"},FS:function(t,r){n.font.size=`${r}`},RRL:function(t,r){t.textAlign="right",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let s=m.row.y;t.currentY-=s,t.fillText(r,t.can.width-n.padding.right,t.currentY);const d=t.measureText(r),e=d.fontBoundingBoxAscent-d.fontBoundingBoxDescent+n.font.spacing;let a=Math.max(s,e);t.currentY+=a,m.row.y=a},LRL:function(t,r){t.textAlign="left",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let s=m.row.y;t.currentY-=s,t.fillText(r,n.padding.left,t.currentY);const d=t.measureText(r),e=d.fontBoundingBoxAscent-d.fontBoundingBoxDescent+n.font.spacing;let a=Math.max(s,e);t.currentY+=a,m.row.y=a},RRF:function(t,r){const s=r.split("-"),d=s.shift().split(":"),e=parseInt(d[0])/100,a=parseInt(d[1]),i=s.join("-");t.textAlign="right",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let f=[i];t.measureText(i).width>o.width*e&&(f=v.wordSplit(t,i,o.width*e,a));let p=0,u=m.row.y;t.currentY-=u;for(let B of f){t.fillText(B,t.can.width-n.padding.right,t.currentY);let R=t.measureText(B),S=R.fontBoundingBoxAscent-R.fontBoundingBoxDescent+n.font.spacing;p+=S,t.currentY+=S}t.currentY-=p;let w=Math.max(u,p);t.currentY+=w,m.row.y=w},LRF:function(t,r){const s=r.split("-"),d=s.shift().split(":"),e=parseInt(d[0])/100,a=parseInt(d[1]),i=s.join("-");t.textAlign="left",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let f=[i];t.measureText(i).width>o.width*e&&(f=v.wordSplit(t,i,o.width*e,a));let p=0,u=m.row.y;t.currentY-=u;for(let B of f){t.fillText(B,n.padding.left,t.currentY);let R=t.measureText(B),S=R.fontBoundingBoxAscent-R.fontBoundingBoxDescent+n.font.spacing;p+=S,t.currentY+=S}t.currentY-=p;let w=Math.max(u,p);t.currentY+=w,m.row.y=w},BARCODE:function(t,r){return new Promise(async(s,d)=>{const e=await E(r);if(e!=0){let a=e.height,i=e.width,f=i/a;i=o.width*.5,a=i/f,i>t.can.width&&(i=t.can.width,a=i/f);let p=t.can.width*.5-i*.5;t.drawImage(e,0,0,e.width,e.height,p,t.currentY,i,a),t.currentY+=a+n.font.spacing*2;const u=r.padStart(10,"0");t.textAlign="center",t.fillText(u,t.can.width*.5,t.currentY),t.currentY+=n.spacing.height}s(!0)})},CL:function(t,r){t.textAlign="center",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let s=[r];t.measureText(r).width>o.width&&(s=v.wordSplit(t,r,o.width));for(let e of s){t.fillText(e,t.can.width*.5,t.currentY);let a=t.measureText(e),i=a.fontBoundingBoxAscent-a.fontBoundingBoxDescent+n.font.spacing;t.currentY+=i}},BG:function(t,r){t.fillStyle="#FFF",t.fillRect(0,0,o.width,o.height)}},o=document.createElement("canvas");o.width=550,o.height=0,o.style.width=`${o.width}px`,o.style.height=`${o.height}px`,o.style.position="absolute",o.style.zIndex="9999999",o.style.top="0px",o.style.left="50%",o.style.transform="translateX(-50%)",o.style.background="white",o.style.border="2px solid black";let y=o.getContext("2d");y.canvasHeight=o.height,y.can=o,y.currentY=0;let k=0;for(let t=0;t<2;t++){const s=g.split(";");y.currentY=n.padding.top,await P.BG(y,""),y.fillStyle="#000";for(let d of s){let e=d.split(":");const a=e[0];e.shift();const i=e.join(":");a in P&&typeof P[a]=="function"&&(m.row.noReset.includes(a)||(m.row.y=m.row.initialY),await P[a](y,i))}if(k!=y.currentY){k=y.currentY;let d=y.currentY+n.padding.bottom;o.height=d,o.style.height=`${o.height}px`,t=0}}let Y=o.toDataURL(),I=Y;if(Y=Y.split(","),Y.shift(),Y=Y.join(","),!h&&("Mine"in window&&(l!=null?("replaceHeight"in l&&l.replaceHeight&&(l.height=Math.ceil(k/24)*4),"width"in l&&"height"in l?("debugging_print"in window&&window.debugging_print&&alert(`ipi_size:${l.width}:${l.height}:`),Mine.postMessage(`ipi_size:${l.width}:${l.height}:`+Y)):console.error("You have not added width and height on size when printing with size")):("debugging_print"in window&&window.debugging_print&&alert("ipi:1:"),Mine.postMessage("ipi:1:"+Y))),o.addEventListener("click",()=>{o.remove()}),!("Mine"in window))){document.body.appendChild(o);const t=document.createElement("img");t.src=I,t.style.position="absolute"}}

//window.invoicePrinting=g=>{console.log(g),k(g)};window.stickerPrinting=(g,l,c=null)=>{const u={width:g,height:c};c==null&&(u.replaceHeight=!0),k(l,u,{pad:{left:40}})};$(document).on("click",".print-btn",function(){const g=document.getElementById("printer-string");g&&"value"in g&&g.value!=""&&k(g.value)});$(document).ready(()=>{if("Main"in window){let g=document.getElementsByClassName("show-app");for(let l of g)l.classList.remove("d-none")}$("#delete-order").click(function(){var g=$(this).data("order-id");Swal.fire({text:window.keys.deleteText+"?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonText,cancelButtonText:window.keys.cancelButtonText,customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then(function(l){l.value?$.ajax({url:"/admin/order/"+g,method:"DELETE",contentType:!1,processData:!1,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(c){location.href="/admin/order"},error:function(c,u,b){}}):l.dismiss==="cancel"&&Swal.fire({text:window.keys.notDeleted,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})})})});function I(g){return new Promise((l,c)=>{const u=new Image;u.onload=()=>{l(u)},u.onerror=()=>{l(0)},u.src=g})}function F(g){return new Promise((l,c)=>{$.ajax({method:"GET",url:"/admin/getBase64Image?value="+g,success:u=>{const b="data:image/png;base64,"+u,n=new Image;n.onload=()=>{l(n)},n.onerror=()=>{l(0)},n.src=b},error:u=>{console.log(u),l(0)}})})}async function k(g,l=null,c=null){let b=50;"invoicePrintSettings"in window&&"logo_height"in window.invoicePrintSettings&&!isNaN(parseFloat(window.invoicePrintSettings.logo_height))&&(b=parseFloat(window.invoicePrintSettings.logo_height));let n={logo:{height:b},spacing:{height:24*.5},font:{size:24,family:"NanumGothicCoding",spacing:10,last:24,weight:"normal"},padding:{top:24,left:0,right:0,bottom:24+76}};c&&"pad"in c&&("top"in c.pad&&(n.padding.top+=c.pad.top),"bottom"in c.pad&&(n.padding.bottom+=c.pad.bottom),"left"in c.pad&&(n.padding.left+=c.pad.left),"right"in c.pad&&(n.padding.right+=c.pad.right));const P={wordSplit(t,r,s,d=0){const e=[],a=r.split(" ");let i="",f=0;for(let h of a){if(f==0){i=h,f++;continue}let w=i+" "+h;e.length!=0&&(w="".padEnd(d)+w),t.measureText(w).width>s?(e.length!=0&&(i="".padEnd(d)+i),e.push(i),i=h):i+=" "+h,f++}e.push(i);let Y=[],p=parseInt(d);if(!isNaN(p)&&p!=0){let h=0;for(let w of e){h++;let B=w;h!=1&&(B="".padEnd(p)+w),Y.push(B)}}else Y=e;return Y}},m={row:{noReset:["RRL","LRL","LRF","RRF"],initialY:0,y:0}},L={LOGO:function(t,r){return new Promise(async(s,d)=>{const e=await I(r);if(e!=0){t.filter="grayscale(1)";const a=e.width/e.height;let i=n.logo.height,f=i*a;f>t.can.width&&(f=t.can.width,i=f/a);let Y=t.can.width*.5-f*.5;t.drawImage(e,0,0,e.width,e.height,Y,t.currentY,f,i),t.currentY+=i+n.spacing.height}s(!0)})},LR:function(t,r){t.currentY+=parseFloat(r)*n.spacing.height},LRR:function(t,r){t.currentY-=parseFloat(r)*n.spacing.height*.5},FL:function(t,r=1.5){let s=parseFloat(r);isNaN(s)&&(s=1.5),t.setLineDash([8]),t.lineWidth=s,t.moveTo(0,t.currentY),t.lineTo(o.width,t.currentY),t.stroke(),t.setLineDash([]),t.currentY+=n.spacing.height*4},R:function(t,r){t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;const s=t.measureText("A");s.fontBoundingBoxAscent-s.fontBoundingBoxDescent+n.font.spacing},B:function(t,r){n.font.weight="600"},UB:function(t,r){n.font.weight="normal"},FS:function(t,r){n.font.size=`${r}`},RRL:function(t,r){t.textAlign="right",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let s=m.row.y;t.currentY-=s,t.fillText(r,t.can.width-n.padding.right,t.currentY);const d=t.measureText(r),e=d.fontBoundingBoxAscent-d.fontBoundingBoxDescent+n.font.spacing;let a=Math.max(s,e);t.currentY+=a,m.row.y=a},LRL:function(t,r){t.textAlign="left",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let s=m.row.y;t.currentY-=s,t.fillText(r,n.padding.left,t.currentY);const d=t.measureText(r),e=d.fontBoundingBoxAscent-d.fontBoundingBoxDescent+n.font.spacing;let a=Math.max(s,e);t.currentY+=a,m.row.y=a},RRF:function(t,r){const s=r.split("-"),d=s.shift().split(":"),e=parseInt(d[0])/100,a=parseInt(d[1]),i=s.join("-");t.textAlign="right",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let f=[i];t.measureText(i).width>o.width*e&&(f=P.wordSplit(t,i,o.width*e,a));let p=0,h=m.row.y;t.currentY-=h;for(let B of f){t.fillText(B,t.can.width-n.padding.right,t.currentY);let R=t.measureText(B),S=R.fontBoundingBoxAscent-R.fontBoundingBoxDescent+n.font.spacing;p+=S,t.currentY+=S}t.currentY-=p;let w=Math.max(h,p);t.currentY+=w,m.row.y=w},LRF:function(t,r){const s=r.split("-"),d=s.shift().split(":"),e=parseInt(d[0])/100,a=parseInt(d[1]),i=s.join("-");t.textAlign="left",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let f=[i];t.measureText(i).width>o.width*e&&(f=P.wordSplit(t,i,o.width*e,a));let p=0,h=m.row.y;t.currentY-=h;for(let B of f){t.fillText(B,n.padding.left,t.currentY);let R=t.measureText(B),S=R.fontBoundingBoxAscent-R.fontBoundingBoxDescent+n.font.spacing;p+=S,t.currentY+=S}t.currentY-=p;let w=Math.max(h,p);t.currentY+=w,m.row.y=w},BARCODE:function(t,r){return new Promise(async(s,d)=>{const e=await F(r);if(e!=0){let a=e.height,i=e.width,f=i/a;i=o.width*.5,a=i/f,i>t.can.width&&(i=t.can.width,a=i/f);let p=t.can.width*.5-i*.5;t.drawImage(e,0,0,e.width,e.height,p,t.currentY,i,a),t.currentY+=a+n.font.spacing*2;const h=r.padStart(10,"0");t.textAlign="center",t.fillText(h,t.can.width*.5,t.currentY),t.currentY+=n.spacing.height}s(!0)})},CL:function(t,r){t.textAlign="center",t.font=`${n.font.weight} ${n.font.size}px ${n.font.family}`;let s=[r];t.measureText(r).width>o.width&&(s=P.wordSplit(t,r,o.width));for(let e of s){t.fillText(e,t.can.width*.5,t.currentY);let a=t.measureText(e),i=a.fontBoundingBoxAscent-a.fontBoundingBoxDescent+n.font.spacing;t.currentY+=i}},BG:function(t,r){t.fillStyle="#FFF",t.fillRect(0,0,o.width,o.height)}},o=document.createElement("canvas");o.width=550,o.height=0,o.style.width=`${o.width}px`,o.style.height=`${o.height}px`,o.style.position="absolute",o.style.zIndex="9999999",o.style.top="0px",o.style.left="50%",o.style.transform="translateX(-50%)",o.style.background="white",o.style.border="2px solid black";let y=o.getContext("2d");y.canvasHeight=o.height,y.can=o,y.currentY=0;let v=0;for(let t=0;t<2;t++){const s=g.split(";");y.currentY=n.padding.top,await L.BG(y,""),y.fillStyle="#000";for(let d of s){let e=d.split(":");const a=e[0];e.shift();const i=e.join(":");a in L&&typeof L[a]=="function"&&(m.row.noReset.includes(a)||(m.row.y=m.row.initialY),await L[a](y,i))}if(v!=y.currentY){v=y.currentY;let d=y.currentY+n.padding.bottom;o.height=d,o.style.height=`${o.height}px`}}let T=o.toDataURL().split(",");T.shift(),T=T.join(","),"Mine"in window&&(l!=null?("replaceHeight"in l&&l.replaceHeight&&(l.height=Math.ceil(v/24)*4),"width"in l&&"height"in l?("debugging_print"in window&&window.debugging_print&&alert(`ipi_size:${l.width}:${l.height}:`),Mine.postMessage(`ipi_size:${l.width}:${l.height}:`+T)):console.error("You have not added width and height on size when printing with size")):("debugging_print"in window&&window.debugging_print&&alert("ipi:1:"),Mine.postMessage("ipi:1:"+T))),o.addEventListener("click",()=>{o.remove()}),"Mine"in window||document.body.appendChild(o)}
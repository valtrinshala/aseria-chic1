var w=function(){var l,a,m=function(){a.querySelectorAll("tbody tr").forEach(o=>{const e=o.querySelectorAll("td"),n=moment(e[4].innerHTML,"DD MMM YYYY, LT").format();e[4].setAttribute("data-order",n)}),l=$(a).DataTable({info:!1,order:[],columnDefs:[{orderable:!1,targets:0},{orderable:!1,targets:4}]}),l.on("draw",function(){d(),u(),f(),KTMenu.init()})},b=()=>{document.querySelector('[data-kt-customer-table-filter="search"]').addEventListener("keyup",function(o){l.search(o.target.value).draw()})},u=()=>{a.querySelectorAll('[data-kt-customer-table-filter="delete_row"]').forEach(o=>{o.addEventListener("click",function(e){e.preventDefault();const n=e.target.getAttribute("data-food-category-id"),s=e.target.closest("tr"),t=s.querySelectorAll("td")[1].innerText;console.log(n),Swal.fire({text:window.keys.deleteText+t+"?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonText,cancelButtonText:window.keys.cancelButtonText,customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then(function(r){r.value?$.ajax({url:"/admin/foodCategory/"+n,method:"DELETE",contentType:!1,processData:!1,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(i){l.row($(s)).remove().draw()},statusCode:{422:function(i){Swal.fire({text:i.responseJSON.error,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn btn-primary"}})}},error:function(i,y,k){console.error(i.responseText)}}):r.dismiss==="cancel"&&Swal.fire({text:t+window.keys.notDeleted,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})})})})},d=()=>{const c=a.querySelectorAll('[type="checkbox"]'),o=document.querySelector('[data-kt-customer-table-select="delete_selected"]');c.forEach(e=>{e.addEventListener("click",function(){setTimeout(function(){f()},50)})}),o.addEventListener("click",function(){Swal.fire({text:window.keys.deleteSelectedCategories,icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonText,cancelButtonText:window.keys.cancelButtonText,customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then(function(e){if(e.value){let n=[];c.forEach(t=>{t.checked&&n.push(t.value)}),$.ajax({url:"/admin/foodCategory/delete/selected",method:"POST",data:{ids:n},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){c.forEach(r=>{r.checked&&(n.push(r.value),l.row($(r.closest("tbody tr"))).remove().draw())})},statusCode:{422:function(t){Swal.fire({text:t.responseJSON.error,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn btn-primary"}}).then(function(r){location.reload()})}},error:function(t,r,i){console.error(t.responseText)}});const s=a.querySelectorAll('[type="checkbox"]')[0];s.checked=!1}else e.dismiss==="cancel"&&Swal.fire({text:window.keys.selectedCategories,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})})})};const f=()=>{const c=document.querySelector('[data-kt-customer-table-toolbar="base"]'),o=document.querySelector('[data-kt-customer-table-toolbar="selected"]'),e=document.querySelector('[data-kt-customer-table-select="selected_count"]'),n=a.querySelectorAll('tbody [type="checkbox"]');let s=!1,t=0;n.forEach(r=>{r.checked&&(s=!0,t++)}),s?(e.innerHTML=t,c.classList.add("d-none"),o.classList.remove("d-none")):(c.classList.remove("d-none"),o.classList.add("d-none"))};return{init:function(){a=document.querySelector("#kt_customers_table"),a&&(m(),d(),b(),u())}}}();KTUtil.onDOMContentLoaded(function(){w.init()});

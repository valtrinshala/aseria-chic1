var b=function(){var s,l,f=function(){l.querySelectorAll("tbody tr").forEach(e=>{const t=e.querySelectorAll("td"),n=moment(t[9].innerHTML,"DD MMM YYYY, LT").format();t[9].setAttribute("data-order",n)}),s=$(l).DataTable({order:[],processing:!0,serverSide:!0,ajax:{url:"/admin/order/all/OrderByAllFilters",type:"GET",data:function(e){e.dateFilter=$("#kt_ecommerce_sales_flatpickr").val()}},columns:[{data:"id",orderable:!1,className:"dt-body-center",render:function(e,t,n){return`
                    <div class="form-check form-check-sm form-check-custom form-check-solid">
                        <input class="form-check-input" type="checkbox" value="${e}">
                    </div>`}},{data:"order_receipt",render:function(e,t,n){return`
                    <a href="${n.order_url}" class="text-gray-800 text-hover-primary mb-1">
                        ${e}
                    </a>`}},{data:"order_number",className:"text-gray-800 fs-10.5 flex-column justify-content-center my-0"},{data:"pos_or_kiosk",render:function(e){return`<div class="text-gray-800 fs-10.5 flex-column justify-content-center my-0">${e}</div>`}},{data:"order_type",render:function(e){return`<div class="text-gray-800 fs-10.5 flex-column justify-content-center my-0">${e}</div>`}},{data:"payable_after_all",render:function(e){return`<div class="text-gray-800 fs-10.5 flex-column justify-content-center my-0">${e}</div>`}},{data:"payment_method_type",className:"text-gray-800 fs-10.5 flex-column justify-content-center my-0"},{data:"created_at",render:function(e){return`<div class="text-gray-800 fs-10.5 flex-column justify-content-center my-0">${e}</div>`}},{data:"status",orderable:!1,render:function(e,t,n){return`<div class="badge badge-light-${n.style}">${e}</div>`}},{data:null,orderable:!1,className:"text-end",render:function(e,t,n){return`
                    <a href="#" class="btn btn-sm btn-light btn-flex border-0 btn-center btn-active-light-primary"
                       data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">${n.actions}<i class="ki-duotone ki-right fs-5 ms-1"></i>
                    </a>
                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600
                                menu-state-bg-light-primary fw-semibold fs-7 w-125px py-4"
                         data-kt-menu="true">
                        <div class="menu-item px-3">
                            <a href="${n.order_url}" class="menu-link px-3">${n.view}</a>
                        </div>
                        <div class="menu-item px-3">
                            <a href="#" class="menu-link px-3 text-danger"
                               data-order-id="${n.id}"
                               data-kt-customer-table-filter="delete_row">${n.delete}</a>
                        </div>
                    </div>`}}],columnDefs:[{orderable:!1,targets:0},{orderable:!1,targets:9}]});const o=document.querySelector("#kt_ecommerce_sales_flatpickr_clear");o&&o.addEventListener("click",e=>{r.clear()});const a=document.querySelector("#kt_ecommerce_sales_flatpickr");let r;r=$(a).flatpickr({altInput:!0,altFormat:"d/m/Y",dateFormat:"Y-m-d",mode:"range",onChange:function(e,t,n){(e.length===2||e.length===0)&&s.ajax.reload()}}),s.on("draw",function(){u(),i(),m(),KTMenu.init()})},y=()=>{document.querySelector('[data-kt-customer-table-filter="search"]').addEventListener("keyup",function(o){s.search(o.target.value).draw()})},i=()=>{l.querySelectorAll('[data-kt-customer-table-filter="delete_row"]').forEach(o=>{o.addEventListener("click",function(a){a.preventDefault();const r=a.target.getAttribute("data-order-id"),e=a.target.closest("tr"),t=e.querySelectorAll("td")[1].innerText;Swal.fire({text:"Are you sure you want to delete "+t+"?",icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonText,cancelButtonText:window.keys.cancelButtonText,customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then(function(n){n.value?$.ajax({url:"/admin/order/"+r,method:"DELETE",contentType:!1,processData:!1,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(d){s.row($(e)).remove().draw()},error:function(d,h,k){console.error(d.responseText)}}):n.dismiss==="cancel"&&Swal.fire({text:t+" "+window.keys.notDeleted,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})})})})},u=()=>{const c=l.querySelectorAll('[type="checkbox"]'),o=document.querySelector('[data-kt-customer-table-select="delete_selected"]');c.forEach(a=>{a.addEventListener("click",function(){setTimeout(function(){m()},50)})}),o.addEventListener("click",function(){Swal.fire({text:window.keys.deleteSelectedOrders,icon:"warning",showCancelButton:!0,buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonText,cancelButtonText:window.keys.cancelButtonText,customClass:{confirmButton:"btn fw-bold btn-danger",cancelButton:"btn fw-bold btn-active-light-primary"}}).then(function(a){if(a.value){let r=[];c.forEach(t=>{t.checked&&(r.push(t.value),s.row($(t.closest("tbody tr"))).remove().draw())}),$.ajax({url:"/admin/order/delete/selected",method:"POST",data:{ids:r},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},error:function(t,n,d){console.error(t.responseText)}});const e=l.querySelectorAll('[type="checkbox"]')[0];e.checked=!1}else a.dismiss==="cancel"&&Swal.fire({text:window.keys.selectedOrders,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})})})};const m=()=>{const c=document.querySelector('[data-kt-customer-table-toolbar="base"]'),o=document.querySelector('[data-kt-customer-table-toolbar="selected"]'),a=document.querySelector('[data-kt-customer-table-select="selected_count"]'),r=l.querySelectorAll('tbody [type="checkbox"]');let e=!1,t=0;r.forEach(n=>{n.checked&&(e=!0,t++)}),e?(a.innerHTML=t,c&&c.classList.add("d-none"),o&&o.classList.remove("d-none")):(c&&c.classList.remove("d-none"),o&&o.classList.add("d-none"))};return{init:function(){if(l=document.querySelector("#kt_customers_table"),!l)return;f(),u(),y(),i();const c=document.querySelector(".sale-pargination-holder");if(c){const r=document.getElementById("kt_customers_table_paginate");r&&c.appendChild(r)}const o=document.querySelector(".sale-search-holder");if(o){const r=document.getElementById("search-custom-input-all");r&&o.appendChild(r)}const a=document.querySelector(".sale-limit-holder");if(a){const r=document.getElementById("kt_customers_table_length");r&&a.appendChild(r)}}}}();KTUtil.onDOMContentLoaded(function(){b.init()});

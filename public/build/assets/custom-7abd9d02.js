const a={};var I="light",c;document.documentElement&&(document.documentElement.hasAttribute("data-bs-theme-mode")?c=document.documentElement.getAttribute("data-bs-theme-mode"):localStorage.getItem("data-bs-theme")!==null?c=localStorage.getItem("data-bs-theme"):c=I,c==="system"&&(c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",c));const P=document.getElementById("proced");let _=document.getElementById("myModal");P.addEventListener("click",function(){currentMode=="none"?Swal.fire({text:window.keys.formsDeliveryProceed,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}}):$(_).modal("show")});var S=document.getElementById("cashModal");$(document).on("click",".meal-drink-swap",function(){h("drink","drinks",this)});$(document).on("click",".meal-fries-swap",function(){h("fries","fries",this)});$(document).on("click",".meal-sauces-swap",function(){h("sauces","sauces",this)});function h(e,t,n){if(!["main_meal","drinks","sauces","fries"].includes(t))return;const o={drinks:"drink_num",fries:"fries_num",sauces:"sauces_num"};if(n.classList.contains("btn-primary"))return;let s=n.getAttribute(`${e}-num`),l=document.querySelectorAll(`.drink-active-holder a[${e}-num="${s}"]`);for(let d of l)d.classList.remove("btn-primary"),d.classList.add("btn-secondary");n.classList.add("btn-primary"),n.classList.remove("btn-secondary"),currentEditting in mealConfigurations||(mealConfigurations[currentEditting]={main_meal:{},drinks:{},sauces:{},fries:{}}),s in mealConfigurations[currentEditting][t]||(mealConfigurations[currentEditting][t][s]={type:"",modifiers:[],sizeSelected:{}});const u=n.getAttribute(`${e}-id`),b=n.getAttribute("owner"),A=currentProducts[u],w=n.getAttribute("group");if(w in modifyingDealPrep){let d={};for(let r of modifyingDealPrep[w])if(r.id==u){d=r;break}let m=n.getAttribute(e+"-num");const f=window[t+"_modGenSwapper"];f.changeParent(`.${e}-size[sel-num="${m}"]`),f.clear();let y=d.size,g=!0;for(let r in y){let k=y[r];if(k==null)continue;let v=parseFloat(k).toFixed(2),M=v,B="+",E=r,x="";g&&(M=d.price,x="active-mod",B="",g=!1),r in window.sizeKeys&&(E=window.sizeKeys[r]);const C={product_id:d.id,mod_name:E,mod_price:v,mod_id:r,active_class:x,mod_price_view:M,plus:B};C[o[t]]=m,f.insert(C)}}if(mealConfigurations[currentEditting][t][s].type=u,b!=u){const d=currentProducts[b],m=parseFloat((parseFloat(A.price)-parseFloat(d.price)).toFixed(5));mealConfigurations[currentEditting][t][s].extraPrice=m}else mealConfigurations[currentEditting][t][s].extraPrice=null;if(mealConfigurations[currentEditting][t][s].sizeSelected={},currentEditting in currentOrderList){let d=currentOrderList[currentEditting];updateQuantity(d,0,0,[],!0)}updateTotalSpan()}$(document).on("click",".meal-fries-mod-swap",function(){handleModifierClick(this)});$(document).on("click",".meal-sauces-mod-swap",function(){handleModifierClick(this)});$(document).on("click",".meal-drink-mod-swap",function(){handleModifierClick(this)});$(document).on("click",'.paymentMethods li a[type="Cash"]',function(){clearRecipientAmount(),updateTotalAndBalance(),cashCalculations.clear(),cashCalculations.change("total",superTotal),updateRecipientAmount("0",!1),updateTotalAndBalance(),window.method={},window.method.id=this.getAttribute("data-table-id"),window.method.type=this.getAttribute("type");for(let e of openedPaymentModals)$(e).modal("hide");openedPaymentModals.push(S),$(S).modal("show")});var F=document.getElementById("discountbtn"),V=document.getElementById("discountModal");F.addEventListener("click",function(){$(V).modal("show")});var T=document.getElementById("bankModal");$(document).on("click",'.paymentMethods li a[type="Card"]',function(){window.method={},window.method.id=this.getAttribute("data-table-id"),window.method.type=this.getAttribute("type");for(let e of openedPaymentModals)$(e).modal("hide");openedPaymentModals.push(T),$(T).modal("show")});var L=document.getElementById("mixModal");$(document).on("click",'.paymentMethods li a[type="Mix"]',function(){clearMixInputs(),cashCalculationsMix.clear(),cashCalculationsMix.change("total",superTotal),runCalculationsMix("0",!1),updateMixInputs(),window.method={},window.method.id=this.getAttribute("data-table-id"),window.method.type=this.getAttribute("type");for(let e of openedPaymentModals)$(e).modal("hide");openedPaymentModals.push(L),$(L).modal("show")});var z=document.getElementById("notesbtn"),O=document.getElementById("notesModal");z.addEventListener("click",function(){$(O).modal("show")});document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".tables li a"),t=document.querySelector(".save-button"),n=document.getElementById("orderTableBody"),i=null;e.forEach(function(o){o.addEventListener("click",function(){i=this.getAttribute("data-table-id"),n.innerHTML="";var s="<tr><td></td><td>Sample Item</td><td>1</td><td>$10.00</td><td></td></tr>";n.innerHTML=s})}),t.addEventListener("click",function(){var o=document.querySelector(".serviceTabe-"+i);o&&(o.style.backgroundColor="#FF36361A",o.style.borderColor="#FF3636")})});$(document).ready(function(){$(".edit-tr").click(function(){$("#orderTableBody>tr").css("transform","translateX(0px)")})});$(document).on("click",".close-payment-modals",function(e){$("#myModal").modal("hide"),$("#cashModal").modal("hide"),$("#bankModal").modal("hide"),$("#mixModal").modal("hide")});$(document).on("click",".locator-keys",function(e){if(this.classList.contains("extra")){if(this.classList.contains("close")){locatorNumber="",$("#loc-num").val(""),$("#tableModal").modal("hide");return}if(this.classList.contains("confirm")){locatorNumberFinal=locatorNumber,locatorNumber="",$("#loc-num").val(""),$("#tableModal").modal("hide"),prepTable();return}return}this.value=="back"?locatorNumber.length>0&&(locatorNumber=locatorNumber.substr(0,locatorNumber.length-1)):locatorNumber+=this.value,$("#loc-num").val(locatorNumber)});$(document).on("click",".plus-btn",function(){const e=$(this).closest(".row-ter");0 in e&&updateQuantity(e,1,e[0].price)});$(document).on("click","[id-open]",function(e){let t=this.getAttribute("id-open");const n=t.split("-");n.length>1&&(n[1],$(`[id*="-${n[1]}"]`).addClass("hide-id")),$(`#${t}`).removeClass("hide-id")});let p=!0;$(document).on("click",".show-keyboard",function(){p?$(".calculator").addClass("d-none"):$(".calculator").removeClass("d-none"),p=!p});$(document).on("click",".add-disc",function(){let e="disc-in";$(`#${e}`);let t=0;e in a&&(t=a[e].steppedValue,a[e].currentValue=t,a[e].lastValue=t,t=parseFloat(t));let i=$("#disc-type")[0].checked;$(".discount-area"),$(".discount-area-amount"),isNaN(t)&&(t=0),window.discountT=i?"solid":"perc",window.discountAmount=t;const o=calculateTotalPrice(!0);i?(t.toFixed(2),t!=0&&(parseFloat(o.noDisc/t)*100).toFixed(2)+""):parseFloat(parseFloat(o.noDisc)*(t*.01)).toFixed(2),$("#discountModal").modal("hide"),window.manualDisc||updateTotalSpan(),window.manualDisc=!1});$(".discard").click(function(e){let t="disc-in";e.preventDefault(),$("#discountModal").modal("hide"),t in a&&(a[t].currentValue=a[t].lastValue,a[t].steppedValue=a[t].lastValue)});$(document).on("click",".minus-btn",function(){const e=$(this).closest(".row-ter");0 in e&&updateQuantity(e,-1,e[0].price)});$(document).on("click",".inner-tab",function(e){const t=$(this).parent().parent();if(t&&t.length>0){const n=t[0].querySelectorAll(".inner-tab");for(let i of n)i!=$(this)[0]&&i.nextElementSibling.classList.remove("active")}$(this).next().each((n,i)=>{i.classList.toggle("active")})});$(document).on("click",".tab-meal-switcher",function(e){(!("manualStep"in window)||!window.manualStep)&&(stepController.currentStep=1/0),$(".tab-meal-switcher").each((i,o)=>{o.classList.remove("active")}),this.classList.add("active");let t=this.getAttribute("tab");$(".meal-modifier-tabs").each((i,o)=>{o.style.display="none"}),$(`.meal-modifier-tabs[layout="${t}"]`).show()});$(document).on("click",".moved-edit .edit-td",function(e){const t=$(this).closest(".row-ter");if(!(0 in t))return;const n=t[0];modalType=0,editRow(n),$(this).closest("tr")[0].classList.remove("moved-edit")});$(document).on("click","#orderTableBody tr td.table-right-side",function(e){const t=$(this).closest("tr")[0],n=t.classList.contains("moved-delete");$(".moved-edit").removeClass("moved-edit"),$(".moved-delete").removeClass("moved-delete"),t.classList.remove("moved-edit"),n||t.classList.add("moved-delete")});$(document).on("click","#orderTableBody tr td.table-left-side",function(e){const t=$(this).closest("tr")[0],n=t.classList.contains("moved-edit");$(".moved-edit").removeClass("moved-edit"),$(".moved-delete").removeClass("moved-delete"),t.classList.remove("moved-delete"),n||t.classList.add("moved-edit")});$(document).on("click",".print-last-receipt",function(){const e=localStorage.getItem("last_printed_string");if(e==null){Swal.fire({text:"{{ __('There is no order history') }}",icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}});return}window.invoicePrinting(e)});$(document).on("click",".open-reports-modal",function(){$("#moreModal").modal("hide"),$("#report-more-modal").modal("show")});$(document).on("click",".print-last-z-report",function(){$.ajax({method:"GET",url:"/admin/pos/printLastZReport",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"json",success:function(e){if(e.status==2){location.href=e.redirect_uri;return}if(e.status==1){Swal.fire({text:e.message,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}});return}if(e.status==0){let t=e.data;if(window.printer_testing||window.connected_printer)if("printString"in t)window.invoicePrinting(t.printString);else{Swal.fire({text:"Probleme me kthimin e serverit ju lutem dergoni mesazh tek mirembajtesit",icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}});return}else Swal.fire({text:window.keys.printerNotConfigured,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})}"message"in e&&e.message!=""&&Swal.fire({text:e.message,icon:"success",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn btn-primary"}})},error:function(e){console.log(e),Swal.fire({text:window.keys.unexpectedError,icon:"error",buttonsStyling:!1,confirmButtonText:window.keys.confirmButtonOk,customClass:{confirmButton:"btn fw-bold btn-primary"}})}})});$(document).on("click",".size-list-item",function(e){const t=this.getAttribute("data-other"),n=this.getAttribute("data-size"),i=this.getAttribute("other-class");if(currentEditting in currentOrderList){let o=currentOrderList[currentEditting],s=$(o)[0].indexFor;setRowSize(s,n,this);let l="btn-violet";i&&(l=i),$(`.size-list-item[data-other="${t}"]`).removeClass(l),this.classList.add(l),updateQuantity(o,0,0,[],!0),updateTotalSpan()}});$(document).on("click","#discountbtn",function(){const e="disc-in";let t="";e in a&&(t=a[e].steppedValue),document.getElementById("disc-in").value=t});$(document).on("click",".dynamic-keypad",function(){if(this.classList.contains("disabled"))return;const e=this.getAttribute("targetting"),t=document.getElementById(e);if(!t)return;let n={steppedValue:"",lastValue:"",currentValue:""};e in a?n=a[e]:a[e]=n;let i=this.getAttribute("value");i=="back"?(n.steppedValue=n.steppedValue.substring(0,n.steppedValue.length-1),e=="disc-in"&&"clearDiscount"in window&&window.clearDiscount==!0&&(n.steppedValue="",n.lastValue="",n.currentValue="",window.clearDiscount=!1)):n.steppedValue+=i,"keypadEvent"in t&&typeof t.keypadEvent=="function"&&t.keypadEvent(n.steppedValue)});$(document).ready(function(){let e="disc-in";const t=document.getElementById(e);t.keypadEvent=n=>{t.value=n}});
